<!DOCTYPE html>
<!--
This is a starter template page. Use this page to start your new project from
scratch. This page gets rid of all links and provides the needed markup only.
-->
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>{$sitetitle}</title>
	<!-- Tell the browser to be responsive to screen width -->
	<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport">
	<!-- Bootstrap 3.3.6 -->
	<load href="__PUBLIC__/bootstrap/css/bootstrap.min.css" />
	<!-- Font Awesome -->
	<load href="__PUBLIC__/plugins/font-awesome/css/font-awesome.min.css" />
	<!-- Ionicons -->
	<load href="__PUBLIC__/plugins/other/ionicons.min.css" />
	<!-- Select2 -->
	<load href="__PUBLIC__/plugins/select2/select2.min.css" />
	<!-- bootstrap slider -->
	.
	<load href="__PUBLIC__/plugins/bootstrap-slider/slider.css" />
	<!-- 最下面 -->
	<!-- Theme style -->
	<load href="__PUBLIC__/dist/css/admincore.css" />
	<!-- AdminLTE Skins. We have chosen the skin-blue for this starter
        page. However, you can choose any other skin. Make sure you
        apply the skin class to the body tag so the changes take effect.
  -->
	<load href="__PUBLIC__/dist/css/skins/skin-blue.min.css" />
	<!-- private css -->
	<load href="__PUBLIC__/jk/css/style.css" />
	<style type="text/css">.adv{display: none;}</style>
	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
	<!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

</head>

<body class="hold-transition skin-blue sidebar-mini ">
	<div class="wrapper">

		<!-- Main Header -->
		<header class="main-header">

			<!-- Logo -->
			<include file="Public/logo" />

			<!-- Header Navbar -->
			<nav class="navbar navbar-static-top" role="navigation">
				<!-- Sidebar toggle button-->
				<a href="#" class="sidebar-toggle" data-toggle="offcanvas"
					role="button">
					<span class="sr-only">Toggle navigation</span>
				</a>

				<!-- 上方导航栏 START -->
				<include file="Public/top_nav" />
				<!-- 上方导航栏 END -->

				<!-- Navbar Right Menu -->
				<include file="Public/top_right_menu" />
				<!-- Navbar Right Menu end -->
			</nav>
		</header>
		<!-- Left side column. contains the logo and sidebar -->
		<aside class="main-sidebar">

			<!-- sidebar: style can be found in sidebar.less -->
			<section class="sidebar">

				<!-- Sidebar user panel (optional) -->

				<!-- search form (Optional) -->

				<!-- /.search form -->

				<!-- Sidebar Menu -->
				<include file="Public/task_sidebar" />
				<!-- /.sidebar-menu -->
			</section>
			<!-- /.sidebar -->
		</aside>

		<!-- Content Wrapper. Contains page content -->
		<div class="content-wrapper">
			<!-- Content Header (Page header) -->
			<section class="content-header">
				<h1>创建任务</h1>
				<ol class="breadcrumb">
					<li>
						<a href="#"> <i class="fa fa-dashboard"></i>
							Level
						</a>
					</li>
					<li class="active">Here</li>
				</ol>
			</section>

			<!-- Main content -->
			<section class="content">
				<!-- Your Page Content Here -->
				<div class="row">
					<div class="col-md-1"></div>
					<div class="col-md-10">
						<!-- Horizontal Form -->
						<div class="box box-info">
							<div class="box-header with-border">
								<h3 class="box-title">http监控任务设置</h3>
							</div>
							<!-- /.box-header -->
							<!-- form start -->
							<form action="__APP__/Task/httptaskadd" class="form-horizontal"  method="post" id="form1">
								<div id="hiddens">
									<input type="hidden" name="adv" value="0">
									<input type="hidden" name="alarm_num" value="0"></div>
								<div class="box-body">
									<div class="form-group">
										<label for="input1" class="col-sm-2 control-label">任务名称：</label>

										<div class="col-sm-10">
											<input type="text" name="title" class="form-control" id="input1" placeholder="任务名称"></div>
									</div>
									<div class="form-group">
										<label for="input2" class="col-sm-2 control-label">http监控地址：</label>

										<div class="col-sm-10">
											<input type="text" name="target" class="form-control" id="input2" placeholder="http监控地址"></div>
									</div>
									<div class="form-group">
										<label class="col-sm-2 control-label">监控点</label>
										<div class="col-sm-10">
											<select class="form-control select2" name="mids[]" multiple="multiple" data-placeholder="点击选择监控点" style="width: 100%;">
												<foreach name="mps" item="vo" >
													<option value="{$vo.id}">{$vo.title}</option>
												</foreach>
											</select>
										</div>
									</div>
									<div class="form-group">
										<label class="col-sm-2 control-label">标签</label>
										<div class="col-sm-8">
											<select class="form-control select2"
											multiple="multiple" name="labels[]" data-placeholder="点击选择标签" style="width: 100%;">
												<option value="1">标签1</option>
												<option value="2">标签2</option>
												<option value="3">标签3</option>
											</select>
										</div>
										<div class="col-sm-2">
											<button type="button" class="btn btn-info pull-left">添加</button>
										</div>
									</div>
									<div class="form-group">
										<label for="input3" class="col-sm-2 control-label"></label>
										<div class="col-sm-10">
											<button id="" onclick="adv_show();" type="button" class="btn btn-info pull-left">高级选项</button>
										</div>
									</div>
									<div class="form-group adv">
										<label for="ex1" class="col-sm-2 control-label">监控频率：</label>
										<div class="col-sm-4">
											<input id="ex1" name="frequency" data-slider-id='blue' type="text" data-slider-min="5" data-slider-max="60" data-slider-step="5" data-slider-value="10"/>
										</div>
										<div class="col-sm-6">
											<span class="ext1v">10分钟</span>
										</div>
									</div>
									<div class="form-group adv" >
										<div class="col-sm-12">
											<div class="divider15"></div>
										</div>
										<label for="input4" class="col-sm-2 control-label" style="font-size: 16px;">监控点采集设置</label>
										<div class="col-sm-10"></div>
									</div>
									<div class="form-group adv">
										<label for="input4" class="col-sm-2 control-label">请求方式:</label>
										<div class="col-sm-10">
											<input type="radio" name="reqtype" value="post" checked>
											post&nbsp;&nbsp;
											<input type="radio" name="reqtype" value="get">
											get&nbsp;&nbsp;
											<input type="radio" name="reqtype" value="head">head&nbsp;&nbsp;</div>
									</div>
									<div class="form-group adv adv_post">
										<label for="input5" class="col-sm-2 control-label">post提交内容：</label>
										<div class="col-sm-10">
											<textarea id="input5" name="postdata" class="form-control" rows="3"></textarea>
										</div>
									</div>
									<div class="form-group adv adv_m1">
										<label for="input6" class="col-sm-2 control-label">匹配响应内容：</label>
										<div class="col-sm-10">
											<textarea id="input6" name="matchresp" class="form-control" rows="3"></textarea>
										</div>
									</div>
									<div class="form-group adv adv_m2">
										<label for="input7" class="col-sm-2 control-label">匹配方式:</label>
										<div class="col-sm-10">
											<input type="radio" name="matchtype" value="1" checked="checked">
											包含匹配内容
											<input type="radio" name="matchtype" value="0">不包含匹配内容</div>
									</div>
									<div class="form-group adv">
										<label for="input8" class="col-sm-2 control-label">Cookies：</label>
										<div class="col-sm-10">
											<textarea id="input8" name="cookies" class="form-control" rows="3" ></textarea>
										</div>
									</div>
									<div class="form-group adv">
										<label for="input9" class="col-sm-2 control-label">http头信息：</label>
										<div class="col-sm-10">
											<textarea id="input9" name="httphead" class="form-control" rows="3" ></textarea>
										</div>
									</div>
									<div class="form-group adv">
										<label for="input10" class="col-sm-2 control-label">http验证用户名：</label>
										<div class="col-sm-10">
											<input type="text" name="httpusername" class="form-control" id="input10" placeholder=""></div>
									</div>
									<div class="form-group adv">
										<label for="input11" class="col-sm-2 control-label">http验证密码：</label>
										<div class="col-sm-10">
											<input type="text" name="httppassword" class="form-control" id="input11" placeholder=""></div>
									</div>
									<div class="form-group adv">
										<label for="input12" class="col-sm-2 control-label">服务器IP：</label>
										<div class="col-sm-10">
											<input type="text" name="serverip" class="form-control" id="input12" placeholder=""></div>
									</div>
									<div class="form-group adv" >
										<div class="col-sm-12">
											<div class="divider15"></div>
										</div>
										<label for="input4" class="col-sm-2 control-label" style="font-size: 16px;">告警设置</label>
										<div class="col-sm-10">
											<button type="button" class="btn btn-info" data-toggle="modal" data-target="#addalarm">增加告警策略</button>
										</div>
									</div>
									<div class="form-group adv" >
										<div class="col-sm-1"></div>
										<div class="col-sm-10">
											<table id="alarm_table" class="table table-bordered">
												<tr>
													<th>指标</th>
													<th>条件</th>
													<th>预警值</th>
													<th>连续告警次数</th>
													<th style="width: 40px">状态</th>
													<th>操作</th>
												</tr>
												<!-- <tr>
												<td>HTTP时延</td>
												<td>大于</td>
												<td>1000ms</td>
												<td>2</td>
												<td>
													<span class="badge bg-green">开启</span>
												</td>
												<td>
													<div class="btn-group">
														<button type="button" class="btn btn-xs btn-info">修改</button>
														<button type="button" class="btn btn-xs btn-info">删除</button>
													</div>
												</td>
											</tr>
											-->
										</table>
									</div>
									<div class="col-sm-1"></div>
								</div>
							</div>
							<!-- /.box-body -->
							<div class="box-footer">
								<button type="button" class="btn btn-info pull-right" onclick="savefrom();">保存</button>
							</div>
							<!-- /.box-footer -->
						</form>
					</div>
				</div>
				<div class="col-md-1"></div>
			</div>

			<!-- 告警模态框（Modal） -->
			<div class="modal fade" id="addalarm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content" >
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
							<h4 class="modal-title" id="myModalLabel">增加告警策略</h4>
						</div>
						<div class="modal-body">
							<!-- modal start -->
							<form class="form-horizontal" role="form" id="form2">
								<div class="form-group">
									<label for="firstname" class="col-sm-3 control-label">监控指标名称：</label>
									<div class="col-sm-9">
										<select class="form-control" id="item_id">
											<foreach name="alarmitems" item="vo" >
												<option value="{$vo.itemid}">{$vo.comment}</option>
											</foreach>
										</select>
									</div>
								</div>
								<div class="form-group">
									<div class="col-sm-1 alarmv1"></div>
									<div class="col-sm-3 alarmv1">
										<select class="form-control" id="op1">
											<option value="gt">大于</option>
											<option value="lt">小于</option>
											<option value="eq">等于</option>
										</select>
									</div>
									<div class="col-sm-5 alarmv1">
										<input type="number" id="threshold1" class="form-control" id="lastname" placeholder=""></div>
									<div class="col-sm-3 alarmv1">
										<select class="form-control" id="unit">
											<option value="ms">毫秒</option>
											<option value="s">秒</option>
										</select>
									</div>
									<div class="col-sm-3 alarmv2"></div>
									<div class="col-sm-3 alarmv2">
										<select class="form-control" id="op2">
											<option value="gt">大于</option>
											<option value="lt">小于</option>
											<option value="eq">等于</option>
										</select>
									</div>
									<div class="col-sm-6 alarmv2">
										<input type="number" id="threshold2" class="form-control" id="lastname" placeholder="百分比">

									</div>
									
								</div>
								<div class="form-group">
									<label for="firstname" class="col-sm-3 control-label">数值计算方式：</label>
									<div class="col-sm-9">
										<select class="form-control" id="calc">
											<option value="0">所有监测点平均</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label for="firstname" class="col-sm-3 control-label">连续告警次数：</label>
									<div class="col-sm-9">
										<select class="form-control" id="atimes">
											<option value="1">1</option>
											<option value="2">2</option>
											<option value="3">3</option>
										</select>
									</div>
								</div>
							</form>
							<!-- modal end -->
						</div>

						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary" onclick="savealarm();">提交保存</button>
						</div>
					</div>
					<!-- /.modal-content -->
				</div>
				<!-- /.modal -->
			</div>
		</section>
		<!-- /.content -->
	</div>
	<!-- /.content-wrapper -->

	<!-- Main Footer -->
	<include file="Public/main_footer" />

	<!-- Control Sidebar -->

	<!-- /.control-sidebar -->
	<!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
	<div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 2.2.3 -->
<load href="__PUBLIC__/plugins/jQuery/jquery-2.2.3.min.js" />
<!-- Bootstrap 3.3.6 -->
<load href="__PUBLIC__/bootstrap/js/bootstrap.min.js" />
<!-- Select2 -->
<load href="__PUBLIC__/plugins/select2/select2.full.min.js" />
<!-- Bootstrap slider -->
<load href="__PUBLIC__/plugins/bootstrap-slider/bootstrap-slider.js" />
<!-- AdminLTE App -->
<load href="__PUBLIC__/dist/js/app.min.js" />
<!-- private JS -->
<load href="__PUBLIC__/jk/js/http.js" />
<!-- Optionally, you can add Slimscroll and FastClick plugins.
     Both of these plugins are recommended to enhance the
     user experience. Slimscroll is required when using the
     fixed layout. -->
<script type="text/javascript">
	/* SELECT2 */
	$(".select2").select2();

	/* BOOTSTRAP SLIDER */
	$('#ex1').slider({
		formatter: function(value) {
			return value + '分钟';
		}
	});
	$('#ex1').on("slide", function(slideEvt) {
		$(".ext1v").text((slideEvt.value + '分钟'));
	});
	
	/* 操作 */
	function adv_show() {
		var adv=$("input[name='adv']").val();
		if(adv == 0){
			$("input[name='adv']").val(1);
			$('.adv').css("display", "block");
		}else{
			$("input[name='adv']").val(0);
			$('.adv').css("display", "none");
		}
	}


	$("input[name='reqtype']").click(function(){
		var m = $(this).val();
		var mp = $('.adv_post');
		var m1 = $('.adv_m1');
		var m2 = $('.adv_m2');
		if(m=='get'){
			mp.css('display', 'none');
			m1.css('display', 'block');
			m2.css('display', 'block');
		}else if(m == 'post'){
			mp.css('display', 'block');
			m1.css('display', 'block');
			m2.css('display', 'block');
		}else if(m == 'head'){
			mp.css('display', 'none');
			m1.css('display', 'none');
			m2.css('display', 'none');
		}
		//console.log($(this).val());
	});

	$("#item_id").change(function(){
		var aitem=$("#item_id").find("option:selected").text();
		var a1 = $('.alarmv1');
		var a2 = $('.alarmv2');
		if(aitem=='可用率'){
			a1.css('display', 'none');
			a2.css('display', 'block');
		}else if(aitem == '链接时间'){
			a2.css('display', 'none');
			a1.css('display', 'block');
		}
	});


	$('.alarmv2').css('display', 'none');
	//adv_show();

	</script>
</body>
</html>